# 项目描述：企业级动画师工作台 (Enterprise Animator Workbench)

## 1. 项目概述
本项目旨在为专业动画师打造一个高效、直观的桌面端工作台，集成了项目管理、镜头编辑、资产管理和 AI 辅助生成等核心功能。通过现代化的 UI 设计和流畅的交互体验，帮助动画师提升工作效率，专注于创意实现。

## 2. 核心功能模块

### 2.1 工作台导航 (Workbench Navigation)
- **模块化设计**: 采用左侧导航栏 (Navigation Rail) 组织核心功能模块。
- **模块列表**:
  - **剧本 (Script)**: 剧本导入与 AI 分析。
  - **分镜 (Storyboard)**: 场景与镜头管理、资产编辑。
  - **角色 (Characters)**: 角色资产库管理。
  - **设置 (Settings)**: 全局偏好设置。

### 2.2 分镜工作台 (Storyboard Workbench)
- **项目侧边栏**:
  - 展示场景和镜头的层级结构。
  - 支持折叠/展开和快速选择。
  - 提供脚本导入快捷入口（切换至剧本模块）。
- **镜头工作区**:
  - **场景概览**: 网格展示场景下的所有镜头卡片。
  - **镜头编辑**: 包含资产版本管理、视频预览和精修功能。

### 2.3 剧本工作台 (Script Workbench)
- **AI 智能分析**:
  - 输入小说、剧本或故事大纲。
  - AI 自动识别场景、角色和动作，生成结构化的分镜头列表。
- **原始文本导入**:
  - 支持粘贴特定格式（如 `SCENE X: ...`, `SHOT Y: ...`）的文本。
  - 自动解析并生成场景和镜头数据。

### 2.4 状态管理与交互
- **全局状态同步**: 使用 Riverpod 管理当前激活的模块 (`currentModule`) 以及选中的场景/镜头。
- **智能导航逻辑**:
  - 模块切换时保持上下文状态。
  - 侧边栏与工作区状态实时联动。

### 2.5 数据模拟与开发支持
- **Mock 数据源**: 内置完整的 Mock 数据（场景、镜头、资产），支持离线开发与 UI 预览。
- **热重载支持**: 优化的代码结构支持 Flutter 热重载，提升开发效率。

## 3. 后端数据模型 (Data Models)

### 3.1 项目 (Project)
- **定义**: 动画项目的顶层容器。
- **属性**:
  - `id`: 唯一标识符 (String)
  - `name`: 项目名称 (String)
  - `createdAt`: 创建时间 (DateTime)
  - `rootPath`: 项目文件根目录路径 (String)

### 3.2 资产 (Asset)
- **定义**: 项目中使用的媒体文件，如图片、视频等。
- **属性**:
  - `id`: 唯一标识符 (String)
  - `projectId`: 所属项目 ID (String)
  - `parentId`: 父资产 ID（用于版本控制/衍生关系） (String?)
  - `type`: 资产类型 (Enum: `imageBase`, `imageRefined`, `video`)
  - `filePath`: 文件存储路径 (String)
  - `metadata`: 元数据（如分辨率、格式等） (Map)
  - `pipelineInfo`: 生产管线信息 (Map)
  - `isMasterReference`: 是否为主参考图 (bool)
  - `createdAt`: 创建时间 (DateTime)

### 3.3 任务 (Task)
- **定义**: 后台处理任务，如 AI 生成、格式转换等。
- **属性**:
  - `id`: 唯一标识符 (String)
  - `type`: 任务类型 (Enum: `refineFaceSwap`, `refineInpainting`, `convert`, `generateVideo`, `generateImage`)
  - `status`: 任务状态 (Enum: `pending`, `processing`, `completed`, `failed`)
  - `sourceAssetId`: 源资产 ID (String)
  - `targetAssetId`: 目标资产 ID (String)
  - `parameters`: 任务参数 (Map)
  - `errorMessage`: 错误信息 (String?)
  - `progress`: 进度 (double, 0.0-1.0)
  - `retryCount`: 重试次数 (int)
  - `createdAt`: 创建时间 (DateTime)
  - `updatedAt`: 更新时间 (DateTime)

### 3.4 场景 (Scene)
- **定义**: 故事的基本单元，包含一组镜头。
- **属性**:
  - `id`: 唯一标识符 (String)
  - `projectId`: 所属项目 ID (String)
  - `name`: 场景名称 (String)
  - `description`: 场景描述 (String)
  - `sequenceNumber`: 序号 (int)
  - `shots`: 镜头列表 (List<Shot>)

### 3.5 镜头 (Shot)
- **定义**: 最小的叙事单元。
- **属性**:
  - `id`: 唯一标识符 (String)
  - `sceneId`: 所属场景 ID (String)
  - `name`: 镜头名称 (String)
  - `description`: 镜头描述 (String)
  - `sequenceNumber`: 序号 (int)

## 4. 技术栈
- **框架**: Flutter (Dart)
- **状态管理**: Riverpod
- **UI 组件**: Material Design 3
- **平台**: Windows / macOS / Linux (桌面端优先)
- **本地存储**: JSON 文件 / SQLite (规划中)

## 5. 设计理念
- **专业性**: 采用深色主题（Dark Mode），符合影视后期软件行业标准。
- **高效性**: 扁平化层级结构，减少点击次数，核心功能触手可及。
- **扩展性**: 模块化代码设计，便于后续集成真实后端 API 和 AI 服务。
